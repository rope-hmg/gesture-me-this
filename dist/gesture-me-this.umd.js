(function(o,r){typeof exports=="object"&&typeof module<"u"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(o=typeof globalThis<"u"?globalThis:o||self,r(o["gesture-me-this"]={}))})(this,function(o){"use strict";class r{constructor(t,e){this.x=t,this.y=e}add(t,e=new r(0,0)){return e.x=this.x+t.x,e.y=this.y+t.y,e}add_assign(t){return this.add(t,this)}sub(t,e=new r(0,0)){return e.x=this.x-t.x,e.y=this.y-t.y,e}sub_assign(t){return this.sub(t,this)}mul(t,e=new r(0,0)){return e.x=this.x*t,e.y=this.y*t,e}mul_assign(t){return this.mul(t,this)}div(t,e=new r(0,0)){return this.mul(1/t,e)}div_assign(t){return this.mul_assign(1/t)}neg(t=new r(0,0)){return this.mul(-1,t)}neg_assign(){return this.mul_assign(-1)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}length_sq(){return this.dot(this)}length(){return Math.sqrt(this.length_sq())}normalise(t=new r(0,0)){return this.mul(1/this.length(),t)}normalise_assign(){return this.mul_assign(1/this.length())}copy_from(t){return this.x=t.x,this.y=t.y,this}set(t,e){this.x=t,this.y=e}}class d{constructor(){this.finger_count=0,this.fingers=new Map,this.centroid=new r(0,0)}}class g{constructor(t,e){this.position_delta=new r(0,0),this.centroid_direction=new r(0,0),this.position=new r(t,e)}is_moving_toward_centroid(){return this.position_delta.dot(this.centroid_direction)>0}angle_delta_around_point(t){const e=this.position.sub(this.position_delta).sub_assign(t).normalise_assign(),s=this.position.sub(t).normalise_assign();return Math.acos(e.dot(s))}}var f=(i=>(i[i.OnStart=0]="OnStart",i[i.OnMove=1]="OnMove",i[i.OnEnd=2]="OnEnd",i[i.OnCancel=3]="OnCancel",i))(f||{});class p{constructor(t,e,s){this.element=t,this.listeners=e,this.user_data=s,this.metrics=new d;const c=n=>{n.preventDefault(),this.initialise_touches(n.changedTouches),this.run_user_handlers(n,0)},h=n=>{n.preventDefault(),this.update_touches(n.changedTouches),this.run_user_handlers(n,1)},u=n=>{n.preventDefault(),this.remove_touches(n.changedTouches),this.run_user_handlers(n,2)},a=n=>{n.preventDefault(),this.remove_all_touches(),this.run_user_handlers(n,3)};t.addEventListener("touchstart",c),t.addEventListener("touchmove",h),t.addEventListener("touchend",u),t.addEventListener("touchcancel",a),this.on_start=c,this.on_move=h,this.on_end=u,this.on_cancel=a}disableGestures(){this.element.removeEventListener("touchstart",this.on_start),this.element.removeEventListener("touchmove",this.on_move),this.element.removeEventListener("touchmove",this.on_end),this.element.removeEventListener("touchmove",this.on_cancel)}run_user_handlers(t,e){const s=this.listeners.get(e);if(s)for(const c of s)c(this.metrics,t,this.user_data)}initialise_touches(t){this.metrics.finger_count+=t.length;for(const e of t){const s=new g(e.clientX,e.clientY);this.metrics.fingers.set(e.identifier,s)}this.calculate_centroid()}update_touches(t){for(const e of t){const s=this.metrics.fingers.get(e.identifier);s&&(s.position_delta.set(e.clientX-s.position.x,e.clientY-s.position.y),s.position.set(e.clientX,e.clientY))}this.calculate_centroid()}remove_touches(t){this.metrics.finger_count-=t.length;for(const e of t)this.metrics.fingers.delete(e.identifier);this.calculate_centroid()}remove_all_touches(){this.metrics.finger_count=0,this.metrics.fingers.clear(),this.metrics.centroid.set(0,0)}calculate_centroid(){const{finger_count:t,fingers:e,centroid:s}=this.metrics;s.set(0,0);for(const c of e.values())s.add_assign(c.position);t>1&&s.div_assign(t);for(const c of e.values())s.sub(c.position,c.centroid_direction)}}var m=(i=>(i[i.Inward=0]="Inward",i[i.Outward=1]="Outward",i))(m||{});const w={sensitivity:.5},y=(i,t)=>{const{exact_finger_count:e,sensitivity:s=.5}=t??w,c=!!e&&i.finger_count===e||!e&&i.finger_count>1;let h;if(c){const u=i.fingers.values();let{value:a,done:n}=u.next(),v=a.is_moving_toward_centroid(),_=!0;for(;!n&&_;)_=v===a.is_moving_toward_centroid(),{value:a,done:n}=u.next();if(_){const x=v?0:1;let l=0;for(const O of i.fingers.values())l+=O.position_delta.length();l/=i.finger_count,l*=s,h={strength:l,direction:x}}}return h?{is_recognised:!0,metrics:h}:{is_recognised:!1}};o.EventType=f,o.Finger=g,o.GestureController=p,o.Metrics=d,o.PinchDirection=m,o.Vector=r,o.pinch_zoom=y,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=gesture-me-this.umd.js.map
